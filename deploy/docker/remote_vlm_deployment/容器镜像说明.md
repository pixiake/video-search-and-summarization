# VSS å®¹å™¨é•œåƒè¯´æ˜å’Œæ›¿æ¢æŒ‡å—

## ğŸ“¦ ä½¿ç”¨çš„å®¹å™¨é•œåƒåˆ—è¡¨

### 1. VSS ä¸»æœåŠ¡
```
é•œåƒ: nvcr.io/nvidia/blueprint/vss-engine:2.4.0
å¤§å°: ~15GB
åŠŸèƒ½: VSS æ ¸å¿ƒå¼•æ“ï¼ŒåŒ…å« VLM æ¨ç†ã€è§†é¢‘å¤„ç†ã€Web UI ç­‰
æ›¿æ¢: å¯ä»¥æ„å»ºè‡ªå·±çš„é•œåƒæˆ–ä½¿ç”¨å…¶ä»–ç‰ˆæœ¬
```

### 2. Neo4j å›¾æ•°æ®åº“
```
é•œåƒ: neo4j:5.26.4
å¤§å°: ~500MB
åŠŸèƒ½: å­˜å‚¨è§†é¢‘äº‹ä»¶çš„å›¾å…³ç³»æ•°æ®
æ›¿æ¢: å¯ä»¥ä½¿ç”¨å…¶ä»– Neo4j ç‰ˆæœ¬ï¼Œå¦‚ neo4j:5.x
```

### 3. ArangoDB æ•°æ®åº“
```
é•œåƒ: arangodb/arangodb:3.12.4
å¤§å°: ~300MB
åŠŸèƒ½: å¤šæ¨¡å‹æ•°æ®åº“ï¼Œç”¨äºæ–‡æ¡£å’Œå›¾æ•°æ®å­˜å‚¨
æ›¿æ¢: å¯ä»¥ä½¿ç”¨ arangodb/arangodb:3.x
```

### 4. MinIO å¯¹è±¡å­˜å‚¨
```
é•œåƒ: minio/minio:latest
å¤§å°: ~200MB
åŠŸèƒ½: S3 å…¼å®¹å¯¹è±¡å­˜å‚¨ï¼Œå­˜å‚¨è§†é¢‘æ–‡ä»¶å’Œç¼“å­˜
æ›¿æ¢: å¯ä»¥ä½¿ç”¨ minio/minio:RELEASE.xxx æŒ‡å®šç‰ˆæœ¬
```

### 5. Milvus å‘é‡æ•°æ®åº“
```
é•œåƒ: milvusdb/milvus:v2.5.4
å¤§å°: ~1GB
åŠŸèƒ½: å‘é‡æ•°æ®åº“ï¼Œå­˜å‚¨ embedding ç”¨äºè¯­ä¹‰æœç´¢
æ›¿æ¢: å¯ä»¥ä½¿ç”¨ milvusdb/milvus:v2.x
```

### 6. Elasticsearchï¼ˆå¯é€‰ï¼‰
```
é•œåƒ: elasticsearch:9.1.2
å¤§å°: ~1GB
åŠŸèƒ½: ç”¨äºæ€§èƒ½ç›‘æ§å’Œæ—¥å¿—åˆ†æï¼ˆä»…åœ¨ perf-profiling æ¨¡å¼ä¸‹å¯ç”¨ï¼‰
æ›¿æ¢: å¯ä»¥ä½¿ç”¨ elasticsearch:8.x æˆ– 9.x
```

### 7. OpenTelemetry Collectorï¼ˆå¯é€‰ï¼‰
```
é•œåƒ: otel/opentelemetry-collector-contrib:latest
å¤§å°: ~100MB
åŠŸèƒ½: æ”¶é›†å’Œå¯¼å‡ºæ€§èƒ½æŒ‡æ ‡ï¼ˆä»…åœ¨ perf-profiling æ¨¡å¼ä¸‹å¯ç”¨ï¼‰
æ›¿æ¢: å¯ä»¥ä½¿ç”¨æŒ‡å®šç‰ˆæœ¬
```

### 8. Prometheusï¼ˆå¯é€‰ï¼‰
```
é•œåƒ: prom/prometheus:latest
å¤§å°: ~200MB
åŠŸèƒ½: ç›‘æ§æŒ‡æ ‡æ”¶é›†ï¼ˆä»…åœ¨ perf-profiling æ¨¡å¼ä¸‹å¯ç”¨ï¼‰
æ›¿æ¢: å¯ä»¥ä½¿ç”¨ prom/prometheus:v2.x
```

### 9. Jaegerï¼ˆå¯é€‰ï¼‰
```
é•œåƒ: jaegertracing/all-in-one:latest
å¤§å°: ~50MB
åŠŸèƒ½: åˆ†å¸ƒå¼è¿½è¸ªï¼ˆä»…åœ¨ perf-profiling æ¨¡å¼ä¸‹å¯ç”¨ï¼‰
æ›¿æ¢: å¯ä»¥ä½¿ç”¨æŒ‡å®šç‰ˆæœ¬
```

---

## ğŸ”„ å¦‚ä½•æ›¿æ¢å®¹å™¨é•œåƒ

### æ–¹æ³• 1ï¼šä¿®æ”¹ .env æ–‡ä»¶ï¼ˆæ¨èï¼‰

```bash
# ç¼–è¾‘ .env æ–‡ä»¶
nano .env

# æ·»åŠ æˆ–ä¿®æ”¹ä»¥ä¸‹å˜é‡
VIA_IMAGE=your-registry.com/custom-vss:latest
```

### æ–¹æ³• 2ï¼šä¿®æ”¹ deploy.sh è„šæœ¬

åœ¨è„šæœ¬çš„ã€Œå®¹å™¨é•œåƒé…ç½®ã€éƒ¨åˆ†ä¿®æ”¹ï¼š

```bash
# å®¹å™¨é•œåƒé…ç½®ï¼ˆå¦‚æœè¦æ›¿æ¢é•œåƒï¼Œä¿®æ”¹è¿™é‡Œï¼‰
export VIA_IMAGE="your-registry.com/custom-vss:latest"
export NEO4J_IMAGE="neo4j:5.25.0"
export ARANGO_IMAGE="arangodb/arangodb:3.11.0"
export MINIO_IMAGE="minio/minio:RELEASE.2024-01-01"
export MILVUS_IMAGE="milvusdb/milvus:v2.5.0"
```

### æ–¹æ³• 3ï¼šç›´æ¥ä¿®æ”¹ compose.yaml

```bash
# ç¼–è¾‘ compose.yaml
nano compose.yaml

# æ‰¾åˆ°å¯¹åº”æœåŠ¡ï¼Œä¿®æ”¹ image å­—æ®µ
services:
  via-server:
    image: your-registry.com/custom-vss:latest
    # ... å…¶ä»–é…ç½®
```

---

## ğŸ“¥ æ‹‰å–å’Œç¼“å­˜é•œåƒ

### é¢„å…ˆæ‹‰å–æ‰€æœ‰é•œåƒ

```bash
# æ‹‰å–æ‰€æœ‰å¿…éœ€çš„é•œåƒï¼ˆé¿å…éƒ¨ç½²æ—¶ç­‰å¾…ï¼‰
docker pull nvcr.io/nvidia/blueprint/vss-engine:2.4.0
docker pull neo4j:5.26.4
docker pull arangodb/arangodb:3.12.4
docker pull minio/minio:latest
docker pull milvusdb/milvus:v2.5.4
```

### æŸ¥çœ‹å·²ä¸‹è½½çš„é•œåƒ

```bash
docker images | grep -E "vss-engine|neo4j|arangodb|minio|milvus"
```

### æ¸…ç†æœªä½¿ç”¨çš„é•œåƒ

```bash
docker image prune -a
```

---

## ğŸ—ï¸ æ„å»ºè‡ªå®šä¹‰ VSS é•œåƒ

å¦‚æœéœ€è¦ä¿®æ”¹ VSS ä¸»æœåŠ¡ï¼š

### 1. åŸºäºå®˜æ–¹é•œåƒæ„å»º

```dockerfile
# Dockerfile.custom
FROM nvcr.io/nvidia/blueprint/vss-engine:2.4.0

# æ·»åŠ è‡ªå®šä¹‰é…ç½®
COPY custom-config.yaml /opt/nvidia/via/custom_config.yaml

# å®‰è£…é¢å¤–ä¾èµ–
RUN pip install your-custom-package

# ä¿®æ”¹ UI
COPY custom-ui/ /opt/nvidia/via/client/
```

### 2. æ„å»ºé•œåƒ

```bash
docker build -f Dockerfile.custom -t my-custom-vss:latest .
```

### 3. ä½¿ç”¨è‡ªå®šä¹‰é•œåƒ

```bash
# åœ¨ .env ä¸­è®¾ç½®
VIA_IMAGE=my-custom-vss:latest
```

---

## ğŸŒ ä½¿ç”¨ç§æœ‰é•œåƒä»“åº“

### 1. ç™»å½•ç§æœ‰ä»“åº“

```bash
docker login your-registry.com
```

### 2. æ¨é€é•œåƒåˆ°ç§æœ‰ä»“åº“

```bash
# æ ‡è®°é•œåƒ
docker tag nvcr.io/nvidia/blueprint/vss-engine:2.4.0 \
  your-registry.com/vss-engine:2.4.0

# æ¨é€
docker push your-registry.com/vss-engine:2.4.0
```

### 3. ä¿®æ”¹ compose.yaml ä½¿ç”¨ç§æœ‰é•œåƒ

```yaml
services:
  via-server:
    image: your-registry.com/vss-engine:2.4.0
```

---

## ğŸ¯ é’ˆå¯¹å›½å†…ç¯å¢ƒçš„ä¼˜åŒ–

### ä½¿ç”¨é•œåƒåŠ é€Ÿå™¨

```bash
# ç¼–è¾‘ Docker é…ç½®
sudo nano /etc/docker/daemon.json

# æ·»åŠ é•œåƒæº
{
  "registry-mirrors": [
    "https://docker.mirrors.ustc.edu.cn",
    "https://hub-mirror.c.163.com"
  ]
}

# é‡å¯ Docker
sudo systemctl restart docker
```

### é¢„ä¸‹è½½é•œåƒåˆ°æœ¬åœ°ä»“åº“

```bash
# 1. ä¸‹è½½é•œåƒ
docker pull nvcr.io/nvidia/blueprint/vss-engine:2.4.0

# 2. ä¿å­˜ä¸ºæ–‡ä»¶
docker save -o vss-engine-2.4.0.tar \
  nvcr.io/nvidia/blueprint/vss-engine:2.4.0

# 3. åœ¨å…¶ä»–æœºå™¨åŠ è½½
docker load -i vss-engine-2.4.0.tar
```

---

## ğŸ” é•œåƒå¤§å°å¯¹æ¯”

| é•œåƒ | å¤§å° | æ˜¯å¦å¿…éœ€ |
|------|------|----------|
| VSS Engine | ~15GB | æ˜¯ |
| Neo4j | ~500MB | æ˜¯ |
| ArangoDB | ~300MB | æ˜¯ |
| MinIO | ~200MB | æ˜¯ |
| Milvus | ~1GB | æ˜¯ |
| Elasticsearch | ~1GB | å¦ï¼ˆä»…ç›‘æ§ç”¨ï¼‰ |
| OpenTelemetry | ~100MB | å¦ï¼ˆä»…ç›‘æ§ç”¨ï¼‰ |
| Prometheus | ~200MB | å¦ï¼ˆä»…ç›‘æ§ç”¨ï¼‰ |
| Jaeger | ~50MB | å¦ï¼ˆä»…ç›‘æ§ç”¨ï¼‰ |

**æ€»è®¡ï¼ˆå¿…éœ€ï¼‰**: ~17GB  
**æ€»è®¡ï¼ˆå«ç›‘æ§ï¼‰**: ~19GB

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **VSS Engine é•œåƒå¾ˆå¤§ï¼ˆ15GBï¼‰**ï¼Œé¦–æ¬¡æ‹‰å–éœ€è¦è¾ƒé•¿æ—¶é—´
2. **Milvus é•œåƒåŒ…å«å¤šä¸ªç»„ä»¶**ï¼Œç¡®ä¿æœ‰è¶³å¤Ÿç£ç›˜ç©ºé—´
3. **ç›‘æ§ç»„ä»¶ï¼ˆElasticsearchã€Prometheusã€Jaegerï¼‰é»˜è®¤ä¸å¯åŠ¨**ï¼Œä»…åœ¨éœ€è¦æ—¶ä½¿ç”¨
4. **å»ºè®®ä½¿ç”¨å›ºå®šç‰ˆæœ¬æ ‡ç­¾**ï¼Œé¿å…ä½¿ç”¨ `latest` å¯¼è‡´ä¸å¯é¢„æœŸçš„æ›´æ–°
5. **ARM æ¶æ„æœºå™¨éœ€è¦ä½¿ç”¨ç‰¹æ®Šé•œåƒ**ï¼š`vss-engine:2.4.0-sbsa`

---

## ğŸ“š ç›¸å…³å‘½ä»¤é€ŸæŸ¥

```bash
# æŸ¥çœ‹æ‰€æœ‰å®¹å™¨
docker compose ps

# æŸ¥çœ‹ç‰¹å®šæœåŠ¡æ—¥å¿—
docker compose logs via-server

# é‡å¯ç‰¹å®šæœåŠ¡
docker compose restart via-server

# åœæ­¢æ‰€æœ‰æœåŠ¡
docker compose down

# åœæ­¢å¹¶åˆ é™¤æ‰€æœ‰æ•°æ®
docker compose down -v

# æ›´æ–°é•œåƒ
docker compose pull
docker compose up -d
```

